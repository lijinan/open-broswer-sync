<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¼å…¥æµè§ˆå™¨æ•°æ®æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .test-section {
            background: white;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .test-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            border-bottom: 2px solid #1890ff;
            padding-bottom: 8px;
        }
        
        .warning-box {
            background: #fff2f0;
            border: 1px solid #ffccc7;
            border-radius: 4px;
            padding: 16px;
            margin: 16px 0;
            color: #ff4d4f;
        }
        
        .warning-box h4 {
            margin: 0 0 10px 0;
            color: #ff4d4f;
        }
        
        .info-box {
            background: #e6f7ff;
            border: 1px solid #91d5ff;
            border-radius: 4px;
            padding: 16px;
            margin: 16px 0;
        }
        
        .info-box h4 {
            margin: 0 0 10px 0;
            color: #1890ff;
        }
        
        .step-list {
            background: #f6ffed;
            border: 1px solid #b7eb8f;
            border-radius: 4px;
            padding: 16px;
            margin: 16px 0;
        }
        
        .step-list h4 {
            margin: 0 0 10px 0;
            color: #52c41a;
        }
        
        .step-list ol {
            margin: 0;
            padding-left: 20px;
        }
        
        .step-list li {
            margin-bottom: 8px;
        }
        
        .feature-card {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            background: #f8f9fa;
        }
        
        .feature-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .feature-icon {
            margin-right: 8px;
            font-size: 18px;
        }
        
        .feature-desc {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .console-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 16px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin: 12px 0;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-success { background: #52c41a; }
        .status-warning { background: #faad14; }
        .status-error { background: #ff4d4f; }
        .status-info { background: #1890ff; }
        
        .btn {
            padding: 10px 20px;
            background: #1890ff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            margin: 5px;
        }
        
        .btn:hover {
            background: #40a9ff;
        }
        
        .btn-danger {
            background: #ff4d4f;
        }
        
        .btn-danger:hover {
            background: #ff7875;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“¥ å¯¼å…¥æµè§ˆå™¨æ•°æ®æµ‹è¯•</h1>
        <p>æµ‹è¯•ä»å½“å‰æµè§ˆå™¨å¯¼å…¥ä¹¦ç­¾æ•°æ®å¹¶è¦†ç›–æœåŠ¡å™¨è´¦å·æ•°æ®</p>
    </div>

    <!-- é‡è¦è­¦å‘Š -->
    <div class="warning-box">
        <h4>âš ï¸ é‡è¦è­¦å‘Š</h4>
        <p><strong>æ­¤åŠŸèƒ½å°†å®Œå…¨è¦†ç›–æ‚¨åœ¨æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰æ•°æ®ï¼</strong></p>
        <ul>
            <li>ğŸ—‘ï¸ åˆ é™¤æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰ä¹¦ç­¾å’Œå¯†ç </li>
            <li>ğŸ“¤ ä¸Šä¼ å½“å‰æµè§ˆå™¨çš„æ‰€æœ‰ä¹¦ç­¾</li>
            <li>ğŸ”’ å¯†ç æ•°æ®éœ€è¦æ‰‹åŠ¨å¯¼å‡ºï¼ˆæµè§ˆå™¨å®‰å…¨é™åˆ¶ï¼‰</li>
            <li>âŒ æ­¤æ“ä½œä¸å¯æ’¤é”€</li>
        </ul>
    </div>

    <!-- åŠŸèƒ½è¯´æ˜ -->
    <div class="test-section">
        <div class="test-title">ğŸ¯ åŠŸèƒ½è¯´æ˜</div>
        
        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ“š</span>
                ä¹¦ç­¾å¯¼å…¥
            </div>
            <div class="feature-desc">
                <strong>æ”¯æŒçš„åŠŸèƒ½ï¼š</strong>
                <ul>
                    <li>âœ… è·å–æµè§ˆå™¨æ‰€æœ‰ä¹¦ç­¾</li>
                    <li>âœ… ä¿æŒæ–‡ä»¶å¤¹ç»“æ„</li>
                    <li>âœ… åŒ…å«ä¹¦ç­¾æ ‡é¢˜ã€URLã€åˆ›å»ºæ—¶é—´</li>
                    <li>âœ… è‡ªåŠ¨æ·»åŠ "æµè§ˆå™¨å¯¼å…¥"æ ‡ç­¾</li>
                </ul>
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ”</span>
                å¯†ç å¯¼å…¥
            </div>
            <div class="feature-desc">
                <strong>å®‰å…¨é™åˆ¶ï¼š</strong>
                <ul>
                    <li>âŒ æµè§ˆå™¨ä¸å…è®¸æ‰©å±•ç›´æ¥è®¿é—®ä¿å­˜çš„å¯†ç </li>
                    <li>ğŸ“‹ éœ€è¦ç”¨æˆ·æ‰‹åŠ¨å¯¼å‡ºå¯†ç æ–‡ä»¶</li>
                    <li>ğŸ”’ è¿™æ˜¯æµè§ˆå™¨çš„å®‰å…¨æœºåˆ¶</li>
                    <li>ğŸ’¡ å»ºè®®ä½¿ç”¨Webç«¯çš„å¯¼å…¥åŠŸèƒ½</li>
                </ul>
            </div>
        </div>

        <div class="feature-card">
            <div class="feature-title">
                <span class="feature-icon">ğŸ”„</span>
                æ•°æ®è¦†ç›–
            </div>
            <div class="feature-desc">
                <strong>æ“ä½œæµç¨‹ï¼š</strong>
                <ul>
                    <li>1ï¸âƒ£ è·å–å½“å‰æµè§ˆå™¨ä¹¦ç­¾</li>
                    <li>2ï¸âƒ£ æ¸…ç©ºæœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰æ•°æ®</li>
                    <li>3ï¸âƒ£ ä¸Šä¼ æµè§ˆå™¨ä¹¦ç­¾åˆ°æœåŠ¡å™¨</li>
                    <li>4ï¸âƒ£ æ˜¾ç¤ºå¯¼å…¥ç»“æœç»Ÿè®¡</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- æµ‹è¯•æ­¥éª¤ -->
    <div class="test-section">
        <div class="test-title">ğŸ“‹ æµ‹è¯•æ­¥éª¤</div>
        
        <div class="step-list">
            <h4>ğŸš€ å‡†å¤‡å·¥ä½œ</h4>
            <ol>
                <li>ç¡®ä¿æ‰©å±•å·²å®‰è£…å¹¶ç™»å½•</li>
                <li>ç¡®ä¿åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ</li>
                <li>åœ¨æµè§ˆå™¨ä¸­æ·»åŠ ä¸€äº›æµ‹è¯•ä¹¦ç­¾</li>
                <li>å¤‡ä»½é‡è¦æ•°æ®ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰</li>
            </ol>
        </div>
        
        <div class="step-list">
            <h4>ğŸ§ª æ‰§è¡Œæµ‹è¯•</h4>
            <ol>
                <li>ç‚¹å‡»æ‰©å±•å›¾æ ‡æ‰“å¼€å¼¹çª—</li>
                <li>ç‚¹å‡»"å¯¼å…¥æµè§ˆå™¨æ•°æ®"æŒ‰é’®</li>
                <li>ä»”ç»†é˜…è¯»è­¦å‘Šä¿¡æ¯</li>
                <li>ç¡®è®¤ä¸¤æ¬¡æ“ä½œæç¤º</li>
                <li>è§‚å¯Ÿå¯¼å…¥è¿›åº¦å’Œç»“æœ</li>
            </ol>
        </div>
        
        <div class="step-list">
            <h4>ğŸ” éªŒè¯ç»“æœ</h4>
            <ol>
                <li>æ‰“å¼€Webç®¡ç†é¢æ¿</li>
                <li>æ£€æŸ¥ä¹¦ç­¾åˆ—è¡¨æ˜¯å¦æ­£ç¡®</li>
                <li>éªŒè¯ä¹¦ç­¾æ•°é‡å’Œå†…å®¹</li>
                <li>æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºæ—¥å¿—</li>
            </ol>
        </div>
    </div>

    <!-- é¢„æœŸè¾“å‡º -->
    <div class="test-section">
        <div class="test-title">ğŸ–¥ï¸ é¢„æœŸæ§åˆ¶å°è¾“å‡º</div>
        
        <h4>æˆåŠŸå¯¼å…¥ç¤ºä¾‹ï¼š</h4>
        <div class="console-output">
ğŸ”„ å¼€å§‹å¯¼å…¥æµè§ˆå™¨æ•°æ®
ğŸ“š è·å–åˆ°æµè§ˆå™¨ä¹¦ç­¾: 15 ä¸ª
ğŸ” è·å–åˆ°æµè§ˆå™¨å¯†ç : 0 ä¸ª
ğŸ—‘ï¸ å·²æ¸…ç©ºæœåŠ¡å™¨æ•°æ®
ğŸ“¤ å·²ä¸Šä¼ ä¹¦ç­¾: 15 ä¸ª
ğŸ“¤ å·²ä¸Šä¼ å¯†ç : 0 ä¸ª
å¯¼å…¥å®Œæˆï¼ä¹¦ç­¾: 15ä¸ªï¼Œå¯†ç : 0ä¸ª
        </div>
        
        <h4>é”™è¯¯æƒ…å†µç¤ºä¾‹ï¼š</h4>
        <div class="console-output">
ğŸ”„ å¼€å§‹å¯¼å…¥æµè§ˆå™¨æ•°æ®
ğŸ“š è·å–åˆ°æµè§ˆå™¨ä¹¦ç­¾: 10 ä¸ª
ğŸ” è·å–åˆ°æµè§ˆå™¨å¯†ç : 0 ä¸ª
ğŸ—‘ï¸ å·²æ¸…ç©ºæœåŠ¡å™¨æ•°æ®
ä¸Šä¼ ä¹¦ç­¾å¤±è´¥: Google ç½‘ç»œé”™è¯¯
ğŸ“¤ å·²ä¸Šä¼ ä¹¦ç­¾: 9 ä¸ª
ğŸ“¤ å·²ä¸Šä¼ å¯†ç : 0 ä¸ª
å¯¼å…¥å®Œæˆï¼ä¹¦ç­¾: 9ä¸ªï¼Œå¯†ç : 0ä¸ª
        </div>
    </div>

    <!-- æµ‹è¯•å·¥å…· -->
    <div class="test-section">
        <div class="test-title">ğŸ› ï¸ æµ‹è¯•å·¥å…·</div>
        
        <div class="info-box">
            <h4>ğŸ“Š æµè§ˆå™¨ä¿¡æ¯</h4>
            <p><strong>æµè§ˆå™¨:</strong> <span id="browserName"></span></p>
            <p><strong>ä¹¦ç­¾APIæ”¯æŒ:</strong> <span id="bookmarkAPI"></span></p>
            <p><strong>æ‰©å±•API:</strong> <span id="extensionAPI"></span></p>
        </div>
        
        <div>
            <button class="btn" onclick="checkBookmarks()">æ£€æŸ¥å½“å‰ä¹¦ç­¾</button>
            <button class="btn" onclick="addTestBookmarks()">æ·»åŠ æµ‹è¯•ä¹¦ç­¾</button>
            <button class="btn btn-danger" onclick="clearTestData()">æ¸…ç†æµ‹è¯•æ•°æ®</button>
        </div>
        
        <div id="testResults" style="margin-top: 16px;"></div>
    </div>

    <!-- æ•…éšœæ’é™¤ -->
    <div class="test-section">
        <div class="test-title">ğŸ”§ æ•…éšœæ’é™¤</div>
        
        <h4><span class="status-indicator status-error"></span>å¯¼å…¥å¤±è´¥</h4>
        <ul>
            <li>æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œåç«¯æœåŠ¡çŠ¶æ€</li>
            <li>ç¡®è®¤å·²æ­£ç¡®ç™»å½•æ‰©å±•</li>
            <li>æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯</li>
            <li>æ£€æŸ¥æµè§ˆå™¨ä¹¦ç­¾æƒé™</li>
        </ul>
        
        <h4><span class="status-indicator status-warning"></span>ä¹¦ç­¾APIä¸å¯ç”¨</h4>
        <ul>
            <li>ç¡®ä¿æ‰©å±•æœ‰ä¹¦ç­¾æƒé™</li>
            <li>æ£€æŸ¥manifestä¸­çš„bookmarksæƒé™</li>
            <li>æŸäº›æµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒä¹¦ç­¾API</li>
        </ul>
        
        <h4><span class="status-indicator status-info"></span>å¯†ç æ— æ³•å¯¼å…¥</h4>
        <ul>
            <li>è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œæµè§ˆå™¨å®‰å…¨é™åˆ¶</li>
            <li>ä½¿ç”¨Webç«¯çš„å¯†ç å¯¼å…¥åŠŸèƒ½</li>
            <li>æ‰‹åŠ¨å¯¼å‡ºæµè§ˆå™¨å¯†ç æ–‡ä»¶</li>
        </ul>
    </div>

    <script>
        // æ˜¾ç¤ºæµè§ˆå™¨ä¿¡æ¯
        const isFirefox = navigator.userAgent.includes('Firefox');
        const isChrome = navigator.userAgent.includes('Chrome') && !navigator.userAgent.includes('Edge');
        const isEdge = navigator.userAgent.includes('Edge');
        
        let browserName = 'Unknown';
        if (isFirefox) browserName = 'Firefox';
        else if (isEdge) browserName = 'Edge';
        else if (isChrome) browserName = 'Chrome';
        
        document.getElementById('browserName').textContent = browserName;
        
        // æ£€æµ‹ä¹¦ç­¾API
        let bookmarkAPIStatus = 'Unknown';
        if (typeof chrome !== 'undefined' && chrome.bookmarks) {
            bookmarkAPIStatus = 'chrome.bookmarks (æ”¯æŒ)';
        } else if (typeof browser !== 'undefined' && browser.bookmarks) {
            bookmarkAPIStatus = 'browser.bookmarks (æ”¯æŒ)';
        } else {
            bookmarkAPIStatus = 'ä¸æ”¯æŒ';
        }
        
        document.getElementById('bookmarkAPI').textContent = bookmarkAPIStatus;
        
        // æ£€æµ‹æ‰©å±•API
        let apiStatus = 'Unknown';
        if (typeof browser !== 'undefined' && browser.runtime) {
            apiStatus = 'browser.* (Firefox)';
        } else if (typeof chrome !== 'undefined' && chrome.runtime) {
            apiStatus = 'chrome.* (Chrome/Edge)';
        } else {
            apiStatus = 'No Extension API';
        }
        
        document.getElementById('extensionAPI').textContent = apiStatus;
        
        // æ£€æŸ¥å½“å‰ä¹¦ç­¾
        async function checkBookmarks() {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = '<p>æ­£åœ¨æ£€æŸ¥ä¹¦ç­¾...</p>';
            
            try {
                if (typeof extensionAPI !== 'undefined' && extensionAPI.bookmarks) {
                    const bookmarks = await extensionAPI.bookmarks.search({});
                    const bookmarkList = bookmarks.filter(b => b.url);
                    
                    resultsDiv.innerHTML = `
                        <div class="info-box">
                            <h4>ğŸ“š å½“å‰ä¹¦ç­¾ç»Ÿè®¡</h4>
                            <p>æ€»ä¹¦ç­¾æ•°: ${bookmarkList.length}</p>
                            <p>æœ€è¿‘5ä¸ªä¹¦ç­¾:</p>
                            <ul>
                                ${bookmarkList.slice(0, 5).map(b => `<li>${b.title} - ${b.url}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                } else {
                    resultsDiv.innerHTML = '<p style="color: red;">ä¹¦ç­¾APIä¸å¯ç”¨</p>';
                }
            } catch (error) {
                resultsDiv.innerHTML = `<p style="color: red;">æ£€æŸ¥ä¹¦ç­¾å¤±è´¥: ${error.message}</p>`;
            }
        }
        
        // æ·»åŠ æµ‹è¯•ä¹¦ç­¾
        async function addTestBookmarks() {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = '<p>æ­£åœ¨æ·»åŠ æµ‹è¯•ä¹¦ç­¾...</p>';
            
            const testBookmarks = [
                { title: 'æµ‹è¯•ä¹¦ç­¾1 - ç™¾åº¦', url: 'https://www.baidu.com' },
                { title: 'æµ‹è¯•ä¹¦ç­¾2 - è°·æ­Œ', url: 'https://www.google.com' },
                { title: 'æµ‹è¯•ä¹¦ç­¾3 - GitHub', url: 'https://github.com' }
            ];
            
            try {
                if (typeof extensionAPI !== 'undefined' && extensionAPI.bookmarks) {
                    let added = 0;
                    for (const bookmark of testBookmarks) {
                        try {
                            await extensionAPI.bookmarks.create(bookmark);
                            added++;
                        } catch (error) {
                            console.error('æ·»åŠ ä¹¦ç­¾å¤±è´¥:', bookmark.title, error);
                        }
                    }
                    
                    resultsDiv.innerHTML = `
                        <div class="step-list">
                            <h4>âœ… æµ‹è¯•ä¹¦ç­¾æ·»åŠ å®Œæˆ</h4>
                            <p>æˆåŠŸæ·»åŠ  ${added} ä¸ªæµ‹è¯•ä¹¦ç­¾</p>
                        </div>
                    `;
                } else {
                    resultsDiv.innerHTML = '<p style="color: red;">ä¹¦ç­¾APIä¸å¯ç”¨ï¼Œæ— æ³•æ·»åŠ æµ‹è¯•ä¹¦ç­¾</p>';
                }
            } catch (error) {
                resultsDiv.innerHTML = `<p style="color: red;">æ·»åŠ æµ‹è¯•ä¹¦ç­¾å¤±è´¥: ${error.message}</p>`;
            }
        }
        
        // æ¸…ç†æµ‹è¯•æ•°æ®
        function clearTestData() {
            const confirmed = confirm('ç¡®å®šè¦æ¸…ç†æµ‹è¯•æ•°æ®å—ï¼Ÿè¿™å°†åˆ é™¤æ ‡é¢˜åŒ…å«"æµ‹è¯•ä¹¦ç­¾"çš„ä¹¦ç­¾ã€‚');
            if (!confirmed) return;
            
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ¸…ç†é€»è¾‘
            document.getElementById('testResults').innerHTML = `
                <div class="warning-box">
                    <h4>ğŸ§¹ æ¸…ç†æç¤º</h4>
                    <p>è¯·æ‰‹åŠ¨åˆ é™¤æµ‹è¯•ä¹¦ç­¾ï¼Œæˆ–ä½¿ç”¨æµè§ˆå™¨çš„ä¹¦ç­¾ç®¡ç†åŠŸèƒ½ã€‚</p>
                </div>
            `;
        }
        
        // è¾“å‡ºè°ƒè¯•ä¿¡æ¯
        console.log('ğŸ“¥ å¯¼å…¥æµè§ˆå™¨æ•°æ®æµ‹è¯•é¡µé¢å·²åŠ è½½');
        console.log('æµè§ˆå™¨:', browserName);
        console.log('ä¹¦ç­¾API:', bookmarkAPIStatus);
        console.log('æ‰©å±•API:', apiStatus);
        
        // æ£€æµ‹æ‰©å±•æ˜¯å¦åŠ è½½
        setTimeout(() => {
            if (typeof extensionAPI !== 'undefined') {
                console.log('âœ… æ‰©å±•APIå…¼å®¹å±‚å·²åŠ è½½');
                console.log('æµè§ˆå™¨ç±»å‹:', extensionAPI.browserInfo);
                console.log('ä¹¦ç­¾APIæ”¯æŒ:', extensionAPI.bookmarks ? 'æ˜¯' : 'å¦');
            } else {
                console.log('âŒ æ‰©å±•APIå…¼å®¹å±‚æœªåŠ è½½ï¼Œè¯·æ£€æŸ¥æ‰©å±•æ˜¯å¦æ­£ç¡®å®‰è£…');
            }
        }, 1000);
    </script>
</body>
</html>
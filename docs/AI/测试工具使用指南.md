# 测试工具使用指南

## 问题解决
**问题**: 测试文件都是打不开的
**原因**: 测试HTML文件需要通过HTTP服务器访问，不能直接在文件系统中打开

## 解决方案

### 方法1: 使用专用测试服务器（推荐）

1. **启动测试服务器**:
   ```bash
   # 方法A: 使用批处理文件
   start-test-server.bat
   
   # 方法B: 直接运行Python脚本
   python start-test-server.py
   ```

2. **访问测试工具**:
   - 打开浏览器访问: http://localhost:8080
   - 选择需要的测试工具进行功能验证

### 方法2: 通过前端服务器访问

1. **确保前端服务器运行**:
   ```bash
   # 在web-client目录下
   npm run dev
   ```

2. **访问测试文件**:
   - 前端服务器: http://localhost:3002
   - 测试文件路径: http://localhost:3002/browser-extension/test/[测试文件名].html

## 可用的测试工具

### 核心功能测试
- **test-user-info.html** - 用户信息测试
  - 验证JWT token和用户信息显示
  - 测试WebSocket连接用户身份

- **test-bookmark-duplicate-fix.html** - 书签重复问题修复测试
  - 验证书签移动时不会重复
  - 测试跨浏览器同步准确性

- **test-firefox-bookmark-sync.html** - Firefox书签同步测试
  - 验证Firefox书签同步功能
  - 测试Firefox事件处理

### 同步功能测试
- **test-folder-sync.html** - 文件夹同步测试
  - 验证文件夹结构同步
  - 测试文件夹路径解析

- **test-cross-browser-move.html** - 跨浏览器移动测试
  - 验证书签跨浏览器移动
  - 测试移动操作同步

- **test-full-sync.html** - 全量同步测试
  - 验证浏览器启动时的全量同步
  - 测试批量数据同步

### WebSocket功能测试
- **test-chrome-websocket.html** - Chrome WebSocket测试
  - 验证Chrome WebSocket连接
  - 测试Service Worker兼容性

- **test-websocket-broadcast.html** - WebSocket广播测试
  - 验证WebSocket消息广播
  - 测试实时通知功能

- **test-realtime-sync.html** - 实时同步测试
  - 验证实时同步功能
  - 测试WebSocket消息处理

### 调试工具
- **debug-chrome-sync.html** - Chrome同步调试工具
  - 调试Chrome同步问题
  - 查看详细同步日志

- **test-backend-status.html** - 后端状态测试
  - 检查后端服务状态
  - 验证API连接

### 技术验证测试
- **test-url-matching.html** - URL匹配逻辑测试
  - 验证书签搜索只按URL匹配
  - 测试标题冲突处理

## 使用前准备

### 1. 启动后端服务
```bash
# 在backend目录下
npm start
```
后端应该运行在: http://localhost:3001

### 2. 安装浏览器扩展
- Chrome: 加载`browser-extension`目录，使用`manifest.json`
- Firefox: 加载`browser-extension`目录，使用`manifest-firefox.json`

### 3. 登录扩展
- 在扩展中输入服务器地址: http://localhost:3001
- 使用测试账号登录

### 4. 启动测试服务器
```bash
# 运行测试服务器
python start-test-server.py
```

## 测试流程建议

### 基础功能验证
1. **test-backend-status.html** - 确认后端服务正常
2. **test-user-info.html** - 验证用户登录和JWT token
3. **test-chrome-websocket.html** - 验证WebSocket连接

### 同步功能验证
1. **test-bookmark-duplicate-fix.html** - 验证重复问题修复
2. **test-firefox-bookmark-sync.html** - 验证Firefox同步功能
3. **test-cross-browser-move.html** - 验证跨浏览器同步

### 高级功能验证
1. **test-folder-sync.html** - 验证文件夹同步
2. **test-full-sync.html** - 验证全量同步
3. **test-realtime-sync.html** - 验证实时同步

## 故障排除

### 测试文件无法访问
- 确保测试服务器正在运行
- 检查端口是否被占用
- 尝试不同的端口号

### 扩展API错误
- 确保在浏览器扩展环境中打开测试页面
- 检查扩展是否正确加载
- 查看浏览器控制台错误信息

### WebSocket连接失败
- 确认后端服务器运行正常
- 检查用户是否已登录
- 验证JWT token是否有效

### 同步功能异常
- 检查"同步收藏夹"是否存在
- 确认书签在正确的文件夹中
- 查看后端日志了解详细错误

## 相关文件
- `start-test-server.py` - Python测试服务器
- `start-test-server.bat` - Windows启动脚本
- `web-client/vite.config.js` - 前端服务器配置
- `browser-extension/test/` - 所有测试文件目录

## 注意事项
- 测试文件必须通过HTTP服务器访问，不能直接打开HTML文件
- 某些功能需要在特定浏览器中测试（如Firefox专用测试）
- 测试前确保所有相关服务都在运行
- 建议按照推荐的测试流程进行验证